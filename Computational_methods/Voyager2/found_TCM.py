import numpy as np
import matplotlib.pyplot as plt
import re
from datetime import datetime
from datetime import timedelta

# FUNZIONI
# Funzione per convertire lo standard temporale da datetime a giuliano
def datetime_to_jd(dtlist):
    base = datetime(1977, 9, 11, 0, 0, 0)
    jd_base = 2443397.5
    return np.array([jd_base + (datetime.strptime(t, '%Y-%m-%d %H:%M:%S') - base).total_seconds() / 86400 for t in dtlist])

# Funzione per convertire lo stadard temporale da giuliano a datetime
def jd_to_datetime(jd):
    base = datetime(1977, 9, 11, 0, 0, 0)
    jd_base = 2443397.5
    days = jd - jd_base
    return base + timedelta(days=days)

# DATI DELLA SIMULAZIONE
blocco = """1977-10-14 00:02:00
[-6003.95229117 34654.92740365  2204.10165756]
1977-10-16 00:02:00
[-6605.17196616 34279.79763275  2150.22652735]
1977-10-18 00:02:00
[-7179.76076019 33896.00300497  2096.93186848]
1977-10-20 00:02:00
[-7728.30885801 33505.08176676  2044.30095111]
1977-10-22 00:02:00
[-8251.47933827 33108.45278303  1992.40524048]
1977-10-24 00:02:00
[-8749.99296713 32707.41811633  1941.30526472]
1977-10-26 00:02:00
[-9224.6145627  32303.16680741  1891.05149792]
1977-10-28 00:02:00
[-9676.14090548 31896.77956625  1841.68523889]
1977-10-30 00:02:00
[-10105.39013611  31489.23412027   1793.23947   ]
1977-11-01 00:02:00
[-10513.19255769  31081.41100236   1745.73968431]
1977-11-03 00:02:00
[-10900.38274403  30674.09959696   1699.20467251]
1977-11-05 00:02:00
[-11267.79284587  30268.00429407   1653.64726363]
1977-11-07 00:02:00
[-11616.24698313  29863.75063047   1609.07501615]
1977-11-09 00:02:00
[-11946.55661131  29461.89132305   1565.49085744]
1977-11-11 00:02:00
[-12259.51675346  29062.91212103   1522.89367153]
1977-11-13 00:02:00
[-12555.90299417  28667.23742348   1481.27883567]
1977-11-15 00:02:00
[-12836.46913888  28275.23562387   1440.63870759]
1977-11-17 00:02:00
[-13101.94544927  27887.22415681   1400.96306546]
1977-11-19 00:02:00
[-13353.03737355  27503.47423292   1362.23950341]
1977-11-21 00:02:00
[-13590.42469819  27124.21525618   1324.45378528]
1977-11-23 00:02:00
[-13814.76105579  26749.63892467   1287.59015977]
1977-11-25 00:02:00
[-14026.67373097  26379.90302124   1251.63164   ]
1977-11-27 00:02:00
[-14226.76371327  26015.1349038    1216.5602505 ]
1977-11-29 00:02:00
[-14415.60595247  25655.43470833   1182.35724451]
1977-12-01 00:02:00
[-14593.74977777  25300.87827898   1149.0032944 ]
1977-12-03 00:02:00
[-14761.7194472   24951.51984129   1116.47865793]
1977-12-05 00:02:00
[-14920.01479897  24607.39443481   1084.76332262]
1977-12-07 00:02:00
[-15069.11198015  24268.52012169   1053.83713075]
1977-12-09 00:02:00
[-15209.46423217  23934.89998764   1023.67988681]
1977-12-11 00:02:00
[-15341.5027157   23606.52395125    994.27144964]
1977-12-13 00:02:00
[-15465.63736046  23283.3703969     965.59181071]
1977-12-15 00:02:00
[-15582.25772789  22965.40764597    937.62116038]
1977-12-17 00:02:00
[-15691.73387679  22652.59528008    910.3399433 ]
1977-12-19 00:02:00
[-15794.41722401  22344.88532924    883.72890453]
1977-12-21 00:02:00
[-15890.64139362  22042.22333709    857.7691273 ]
1977-12-23 00:02:00
[-15980.72304962  21744.54931456    832.44206362]
1977-12-25 00:02:00
[-16064.96270799  21451.79859224    807.72955852]
1977-12-27 00:02:00
[-16143.64552514  21163.90258134    783.61386896]
1977-12-29 00:02:00
[-16217.04206023  20880.78945172    760.07767787]
1977-12-31 00:02:00
[-16285.40901001  20602.3847351     737.10410416]
1978-01-02 00:02:00
[-16348.98991504  20328.61186076    714.67670915]
1978-01-04 00:02:00
[-16408.01583679  20059.39263035    692.77949996]
1978-01-06 00:02:00
[-16462.70600543  19794.64763788    671.39693033]
1978-01-08 00:02:00
[-16513.2684385   19534.29664051    650.51389923]
1978-01-10 00:02:00
[-16559.90053068  19278.25888509    630.11574757]
1978-01-12 00:02:00
[-16602.78961533  19026.45339505    610.18825344]
1978-01-14 00:02:00
[-16642.11349843  18778.79922165    590.71762596]
1978-01-16 00:02:00
[-16678.0409657   18535.21566348    571.69049812]
1978-01-18 00:02:00
[-16710.73226389  18295.62245737    553.09391873]
1978-01-20 00:02:00
[-16740.339557    18059.93994385    534.91534372]
1978-01-22 00:02:00
[-16767.00735868  17828.0892098     517.14262679]
1978-01-24 00:02:00
[-16790.87294152  17599.99221086    499.76400977]
1978-01-26 00:02:00
[-16812.0667245   17375.57187569    482.76811258]
1978-01-28 00:02:00
[-16830.71263944  17154.75219405    466.14392305]
1978-01-30 00:02:00
[-16846.92847752  16937.45829064    449.88078653]
1978-02-01 00:02:00
[-16860.82621688  16723.61648611    433.96839558]
1978-02-03 00:02:00
[-16872.51233217  16513.1543468     418.39677947]
1978-02-05 00:02:00
[-16882.08808702  16306.00072447    403.15629394]
1978-02-07 00:02:00
[-16889.64981036  16102.08578712    388.23761091]
1978-02-09 00:02:00
[-16895.28915741  15901.34104205    373.63170838]
1978-02-11 00:02:00
[-16899.09335613  15703.69935199    359.32986049]
█1978-02-13 00:02:00
[-16901.14544004  15509.09494517    345.32362775]
1978-02-15 00:02:00
[-16901.52446805  15317.46342007    331.60484748]
1978-02-17 00:02:00
[-16900.30573206  15128.74174548    318.16562444]
1978-02-19 00:02:00
[-16897.56095303  14942.86825663    304.99832178]
1978-02-21 00:02:00
[-16893.35846615  14759.78264759    292.09555211]
1978-02-23 00:02:00
[-16887.76339579  14579.4259608     279.45016888]
1978-02-25 00:02:00
[-16880.83782065  14401.74057389    267.05525803]
1978-02-27 00:02:00
[-16872.64092986  14226.6701842     254.9041298 ]
1978-03-01 00:02:00
[-16863.22917048  14054.15979152    242.99031094]
1978-03-03 00:02:00
[-16852.65638679  13884.15567906    231.30753698]
1978-03-05 00:02:00
[-16840.97395203  13716.60539317    219.84974493]
1978-03-07 00:02:00
[-16828.23089287  13551.45772195    208.61106611]
1978-03-09 00:02:00
[-16814.47400707  13388.66267286    197.58581924]
1978-03-11 00:02:00
[-16799.74797481  13228.17144972    186.76850382]
1978-03-13 00:02:00
[-16784.09546389  13069.93642913    176.1537937 ]
1978-03-15 00:02:00
[-16767.55722926  12913.91113645    165.73653085]
1978-03-17 00:02:00
[-16750.17220723  12760.05022149    155.51171942]
1978-03-19 00:02:00
[-16731.97760452  12608.3094341     145.47451994]
1978-03-21 00:02:00
[-16713.00898261  12458.64559953    135.62024381]
1978-03-23 00:02:00
[-16693.30033757  12311.01659389    125.9443479 ]
1978-03-25 00:02:00
[-16672.88417568  12165.38131964    116.44242943]
1978-03-27 00:02:00
[-16651.79158503  12021.69968124    107.11022098]
1978-03-29 00:02:00
[-16630.05230343  11879.93256103     97.94358575]
1978-03-31 00:02:00
[-16607.69478265  11740.04179539     88.93851291]
1978-04-02 00:02:00
[-16584.74624945  11601.99015114     80.09111322]
1978-04-04 00:02:00
[-16561.23276325  11465.7413024      71.39761477]
1978-04-06 00:02:00
[-16537.179271    11331.25980768     62.85435885]
1978-04-08 00:02:00
[-16512.60965904  11198.51108742     54.457796  ]
1978-04-10 00:02:00
[-16487.54680241  11067.46140193     46.20448225]
1978-04-12 00:02:00
[-16462.01261161  10938.07782969     38.09107543]
1978-04-14 00:02:00
[-16436.02807697  10810.32824616     30.11433168]
1978-04-16 00:02:00
[-16409.61331075  10684.18130295     22.27110204]
1978-04-18 00:02:00
[-1.63827876e+04  1.05596064e+04  1.45583292e+01]
1978-04-20 00:02:00
[-1.63555694e+04  1.04365737e+04  6.97304433e+00]
1978-04-22 00:02:00
[-1.63279764e+04  1.03150540e+04 -4.87635819e-01]
1978-04-24 00:02:00
[-1.63000256e+04  1.01950190e+04 -7.82651197e+00]
1978-04-26 00:02:00
[-1.62717333e+04  1.00764408e+04 -1.50463050e+01]
1978-04-28 00:02:00
[-16243.11517578   9959.29234668    -22.14965881]
1978-04-30 00:02:00
[-16214.18609322   9843.54717101    -29.13914256]
1978-05-02 00:02:00
[-16184.9604727    9729.17944451    -36.01725355]
1978-05-04 00:02:00
[-16155.45210484   9616.16394318    -42.78641939]
1978-05-06 00:02:00
[-16125.67422384   9504.47603614    -49.4490004 ]
1978-05-08 00:02:00
[-16095.63953166   9394.0916697     -56.00729178]
1978-05-10 00:02:00
[-16065.36022109   9284.98735195    -62.46352579]
1978-05-12 00:02:00
[-16034.84799761   9177.14013778    -68.81987378]
1978-05-14 00:02:00
[-16004.11410035   9070.5276142     -75.07844822]
1978-05-16 00:02:00
[-15973.16932199   8965.12788623    -81.24130454]
1978-05-18 00:02:00
[-15942.02402771   8860.919563      -87.31044305]
1978-05-20 00:02:00
[-15910.6881733    8757.88174443    -93.28781067]
1978-05-22 00:02:00
[-15879.1713224    8655.9940081     -99.17530262]
1978-05-24 00:02:00
[-15847.48266298   8555.23639663   -104.97476411]
1978-05-26 00:02:00
[-15815.63102299   8455.58940537   -110.68799192]
1978-05-28 00:02:00
[-15783.62488535   8357.03397042   -116.31673589]
1978-05-30 00:02:00
[-15751.47240223   8259.551457     -121.86270044]
1978-06-01 00:02:00
[-15719.18140869   8163.12364817   -127.32754598]
1978-06-03 00:02:00
[-15686.75943572   8067.73273391   -132.71289027]"""

# ESTRAGGO I DATI DAL BLOCCO PRECEDENTE
righe = [r for r in blocco.strip().split('\n') if r.strip()] # extract rows
vel_nuove = []
tempi_nuovi = []

# accetta blocchi che iniziano sia con la data che con il vettore
vel_nuove = []
tempi_nuovi = []
i = 0
while i < len(righe)-1:
    # Se la riga corrente è una data, la successiva è il vettore
    try:
        datetime.strptime(righe[i], '%Y-%m-%d %H:%M:%S')
        tempi_nuovi.append(righe[i])
        v = np.fromstring(righe[i+1].replace('[','').replace(']',''), sep=' ')
        vel_nuove.append(v)
        i += 2
    except ValueError:
        # Se la riga corrente non è una data, prova la successiva
        try:
            datetime.strptime(righe[i+1], '%Y-%m-%d %H:%M:%S')
            tempi_nuovi.append(righe[i+1])
            v = np.fromstring(righe[i].replace('[','').replace(']',''), sep=' ')
            vel_nuove.append(v)
            i += 2
        except ValueError:
            i += 1  # Salta righe non valide
vel_nuove = np.array(vel_nuove)/1000

# Converto i tempi
jd_nuovi = datetime_to_jd(tempi_nuovi)

# DATI DI CONFRONTO (DA HORIZONS)
data = """2443429.501388889 = A.D. 1977-Oct-13 00:02:00.0000 TDB 
 X = 1.533884806436137E+08 Y = 8.819162359412152E+07 Z = 1.322272786737997E+07
 VX=-5.689389410363809E+00 VY= 3.484726478917138E+01 VZ= 2.234577861660480E+00
 LT= 5.918354806859020E+02 RG= 1.774278134864381E+08 RR= 1.256903995640675E+01
2443431.501388889 = A.D. 1977-Oct-15 00:02:00.0000 TDB 
 X = 1.523518512658701E+08 Y = 9.418139648742320E+07 Z = 1.360417920668849E+07
 VX=-6.304111009897269E+00 VY= 3.447709137779815E+01 VZ= 2.180448902611481E+00
 LT= 5.991752309791052E+02 RG= 1.796282152679437E+08 RR= 1.289508357030171E+01
2443433.501388889 = A.D. 1977-Oct-17 00:02:00.0000 TDB 
 X = 1.512113297428182E+08 Y = 1.001063607866145E+08 Z = 1.397632174123595E+07
 VX=-6.891928527629963E+00 VY= 3.409744193557633E+01 VZ= 2.126853069479999E+00
 LT= 6.066969480605117E+02 RG= 1.818831693201591E+08 RR= 1.320055472376976E+01
2443435.501388889 = A.D. 1977-Oct-19 00:02:00.0000 TDB 
 X = 1.499715190109307E+08 Y = 1.059650189536479E+08 Z = 1.433925552238154E+07
 VX=-7.453390337219373E+00 VY= 3.370991579161427E+01 VZ= 2.073880003033775E+00
 LT= 6.143889896138594E+02 RG= 1.841891853644754E+08 RR= 1.348620705119558E+01
2443437.501388889 = A.D. 1977-Oct-21 00:02:00.0000 TDB 
 X = 1.486369199962751E+08 Y = 1.117561394075499E+08 Z = 1.469309502160394E+07
 VX=-7.989125943168482E+00 VY= 3.331599200367073E+01 VZ= 2.021607100525411E+00
 LT= 6.222401560514130E+02 RG= 1.865429058489566E+08 RR= 1.375282124376141E+01
2443439.501388889 = A.D. 1977-Oct-23 00:02:00.0000 TDB 
 X = 1.472119190008493E+08 Y = 1.174787358808153E+08 Z = 1.503796708791116E+07
 VX=-8.499829970515826E+00 VY= 3.291703122475143E+01 VZ= 1.970100368251654E+00
 LT= 6.302397030240628E+02 RG= 1.889411096987738E+08 RR= 1.400119457754711E+01
2443441.501388889 = A.D. 1977-Oct-25 00:02:00.0000 TDB 
 X = 1.457007777199959E+08 Y = 1.231320472207038E+08 Z = 1.537400905526517E+07
 VX=-8.986247725416295E+00 VY= 3.251427893173712E+01 VZ= 1.919415301118393E+00
 LT= 6.383773482949974E+02 RG= 1.913807143768794E+08 RR= 1.423213181892771E+01
2443443.501388889 = A.D. 1977-Oct-27 00:02:00.0000 TDB 
 X = 1.441076256193942E+08 Y = 1.287155178437291E+08 Z = 1.570136700267785E+07
 VX=-9.449162320942367E+00 VY= 3.210886970781824E+01 VZ= 1.869597766916362E+00
 LT= 6.466432737524029E+02 RG= 1.938587764873998E+08 RR= 1.444643743804487E+01
2443445.501388889 = A.D. 1977-Oct-29 00:02:00.0000 TDB 
 X = 1.424364544040381E+08 Y = 1.342287790009933E+08 Z = 1.602019416626937E+07
 VX=-9.889383328354047E+00 VY= 3.170183230262444E+01 VZ= 1.820684878356500E+00
 LT= 6.550281232882502E+02 RG= 1.963724911397116E+08 RR= 1.464490903546755E+01
2443447.501388889 = A.D. 1977-Oct-31 00:02:00.0000 TDB 
 X = 1.406911143218267E+08 Y = 1.396716309682105E+08 Z = 1.633064949993291E+07
 VX=-1.030773687751291E+01 VY= 3.129409523847282E+01 VZ= 1.772705838445461E+00
 LT= 6.635229972151650E+02 RG= 1.989191902746615E+08 RR= 1.482833188612873E+01
2443449.501388889 = A.D. 1977-Nov-02 00:02:00.0000 TDB 
 X = 1.388753120588972E+08 Y = 1.450440262367907E+08 Z = 1.663289637897845E+07
 VX=-1.070505711804932E+01 VY= 3.088649275981713E+01 VZ= 1.725682749760887E+00
 LT= 6.721194438335801E+02 RG= 2.014963401364619E+08 RR= 1.499747448838585E+01
2443451.501388889 = A.D. 1977-Nov-04 00:02:00.0000 TDB 
 X = 1.369926100004017E+08 Y = 1.503460537505653E+08 Z = 1.692710144003879E+07
 VX=-1.108217893520606E+01 VY= 3.047977096139182E+01 VZ= 1.679631380078016E+00
 LT= 6.808094486973228E+02 RG= 2.041015380545953E+08 RR= 1.515308501186380E+01
2443453.501388889 = A.D. 1977-Nov-06 00:02:00.0000 TDB 
 X = 1.350464266496280E+08 Y = 1.555779242070290E+08 Z = 1.721343354909513E+07
 VX=-1.143993180904346E+01 VY= 3.007459396064583E+01 VZ= 1.634561879622266E+00
 LT= 6.895854220655326E+02 RG= 2.067325086819935E+08 RR= 1.529588853875298E+01
2443455.501388889 = A.D. 1977-Nov-08 00:02:00.0000 TDB 
 X = 1.330400380174753E+08 Y = 1.607399564209694E+08 Z = 1.749206288908643E+07
 VX=-1.177913470557763E+01 VY= 2.967155000549756E+01 VZ= 1.590479447496525E+00
 LT= 6.984401849682016E+02 RG= 2.093870998175918E+08 RR= 1.542658499552563E+01
2443457.501388889 = A.D. 1977-Nov-10 00:02:00.0000 TDB 
 X = 1.309765798135993E+08 Y = 1.658325647317506E+08 Z = 1.776316015820148E+07
 VX=-1.210059188877182E+01 VY= 2.927115743388243E+01 VZ= 1.547384946230427E+00
 LT= 7.073669542556192E+02 RG= 2.120632779242656E+08 RR= 1.554584768051965E+01
2443459.501388889 = A.D. 1977-Nov-12 00:02:00.0000 TDB 
 X = 1.288590502894406E+08 Y = 1.708562474229736E+08 Z = 1.802689586988576E+07
 VX=-1.240508954623583E+01 VY= 2.887387042263283E+01 VZ= 1.505275464604809E+00
 LT= 7.163593269499136E+02 RG= 2.147591234375402E+08 RR= 1.565432230094992E+01
2443461.501388889 = A.D. 1977-Nov-14 00:02:00.0000 TDB 
 X = 1.266903136013098E+08 Y = 1.758115761139460E+08 Z = 1.828343974571835E+07
 VX=-1.269339312827034E+01 VY= 2.848008448001474E+01 VZ= 1.464144830007600E+00
 LT= 7.254112641691189E+02 RG= 2.174728259461474E+08 RR= 1.575262644000962E+01
2443463.501388889 = A.D. 1977-Nov-16 00:02:00.0000 TDB 
 X = 1.244731035783828E+08 Y = 1.806991860757464E+08 Z = 1.853296019260839E+07
 VX=-1.296624530753660E+01 VY= 2.809014165031906E+01 VZ= 1.423984072379350E+00
 LT= 7.345170748505949E+02 RG= 2.202026793124298E+08 RR= 1.584134938229503E+01
2443465.501388889 = A.D. 1977-Nov-18 00:02:00.0000 TDB 
 X = 1.222100277958412E+08 Y = 1.855197674202955E+08 Z = 1.877562385615491E+07
 VX=-1.322436447397191E+01 VY= 2.770433541125059E+01 VZ= 1.384781842225019E+00
 LT= 7.436713994617205E+02 RG= 2.229470767889290E+08 RR= 1.592105223445269E+01
2443467.501388889 = A.D. 1977-Nov-20 00:02:00.0000 TDB 
 X = 1.199035718675220E+08 Y = 1.902740571084467E+08 Z = 1.901159524246168E+07
 VX=-1.346844368691773E+01 VY= 2.732291525513151E+01 VZ= 1.346524785367402E+00
 LT= 7.528691938519364E+02 RG= 2.257045061773505E+08 RR= 1.599226828654117E+01
2443469.501388889 = A.D. 1977-Nov-22 00:02:00.0000 TDB 
 X = 1.175561038852161E+08 Y = 1.949628317222248E+08 Z = 1.924103640118088E+07
 VX=-1.369915001482365E+01 VY= 2.694609095213630E+01 VZ= 1.309197877378693E+00
 LT= 7.621057133708248E+02 RG= 2.284735450672830E+08 RR= 1.605550356618344E+01
2443471.501388889 = A.D. 1977-Nov-24 00:02:00.0000 TDB 
 X = 1.151698789429958E+08 Y = 1.995869009464429E+08 Z = 1.946410666309775E+07
 VX=-1.391712420199677E+01 VY= 2.657403649825630E+01 VZ= 1.272784720971512E+00
 LT= 7.713764973506505E+02 RG= 2.312528561841820E+08 RR= 1.611123754228050E+01
2443473.501388889 = A.D. 1977-Nov-26 00:02:00.0000 TDB 
 X = 1.127470436951608E+08 Y = 2.041471017054354E+08 Z = 1.968096242609034E+07
 VX=-1.412298060724037E+01 VY= 2.620689375712407E+01 VZ= 1.237267809294739E+00
 LT= 7.806773540282059E+02 RG= 2.340411828690520E+08 RR= 1.615992394368712E+01
2443475.501388889 = A.D. 1977-Nov-28 00:02:00.0000 TDB 
 X = 1.102896409034363E+08 Y = 2.086442929057499E+08 Z = 1.989175698398468E+07
 VX=-1.431730736479970E+01 VY= 2.584477580726868E+01 VZ= 1.202628757743021E+00
 LT= 7.900043459688445E+02 RG= 2.368373447086823E+08 RR= 1.620199166376496E+01
2443477.501388889 = A.D. 1977-Nov-30 00:02:00.0000 TDB 
 X = 1.077996139429004E+08 Y = 2.130793507283063E+08 Z = 2.009664039270028E+07
 VX=-1.450066673021828E+01 VY= 2.548777000910702E+01 VZ= 1.168848508056509E+00
 LT= 7.993537760216107E+02 RG= 2.396402333251002E+08 RR= 1.623784572301664E+01
2443479.501388889 = A.D. 1977-Dec-02 00:02:00.0000 TDB 
 X = 1.052788112321404E+08 Y = 2.174531644318398E+08 Z = 2.029575936969244E+07
 VX=-1.467359557013023E+01 VY= 2.513594080632979E+01 VZ= 1.135907506193540E+00
 LT= 8.087221738496291E+02 RG= 2.424488083374836E+08 RR= 1.626786827141301E+01
2443481.501388889 = A.D. 1977-Dec-04 00:02:00.0000 TDB 
 X = 1.027289905698010E+08 Y = 2.217666326163940E+08 Z = 2.048925722198665E+07
 VX=-1.483660596907865E+01 VY= 2.478933227753909E+01 VZ= 1.103785857712893E+00
 LT= 8.181062830405949E+02 RG= 2.452620934979837E+08 RR= 1.629241960989344E+01
2443483.501388889 = A.D. 1977-Dec-06 00:02:00.0000 TDB 
 X = 1.001518233579662E+08 Y = 2.260206599078354E+08 Z = 2.067727379926310E+07
 VX=-1.499018592471051E+01 VY= 2.444797045561867E+01 VZ= 1.072463462292895E+00
 LT= 8.275030488093453E+02 RG= 2.480791730050476E+08 RR= 1.631183921883969E+01
2443485.501388889 = A.D. 1977-Dec-08 00:02:00.0000 TDB 
 X = 9.754889869939838E+07 Y = 2.302161540243302E+08 Z = 2.085994546855512E+07
 VX=-1.513480010924222E+01 VY= 2.411186543166962E+01 VZ= 1.041920129758887E+00
 LT= 8.369096062925087E+02 RG= 2.508991879942434E+08 RR= 1.632644678197368E+01
2443487.501388889 = A.D. 1977-Dec-10 00:02:00.0000 TDB 
 X = 9.492172735881446E+07 Y = 2.343540231888437E+08 Z = 2.103740510755664E+07
 VX=-1.527089067880468E+01 VY= 2.378101325857649E+01 VZ= 1.012135679761657E+00
 LT= 8.463232694293880E+02 RG= 2.537213332048325E+08 RR= 1.633654319515804E+01
2443489.501388889 = A.D. 1977-Dec-12 00:02:00.0000 TDB 
 X = 9.227174558133799E+07 Y = 2.384351738544162E+08 Z = 2.120978211387204E+07
 VX=-1.539887811465628E+01 VY= 2.345539767023567E+01 VZ= 9.830900268943186E-01
 LT= 8.557415204182408E+02 RG= 2.565448538188415E+08 RR= 1.634241155319696E+01
2443491.501388889 = A.D. 1977-Dec-14 00:02:00.0000 TDB 
 X = 8.960031876383862E+07 Y = 2.424605087117282E+08 Z = 2.137720242783076E+07
 VX=-1.551916208261563E+01 VY= 2.313499163203193E+01 VZ= 9.547632528292098E-01
 LT= 8.651619997338119E+02 RG= 2.593690424683948E+08 RR= 1.634431810973334E+01
2443493.501388889 = A.D. 1977-Dec-16 00:02:00.0000 TDB 
 X = 8.690874497699389E+07 Y = 2.464309249510315E+08 Z = 2.153978856675524E+07
 VX=-1.563212229978235E+01 VY= 2.281975873665485E+01 VZ= 9.271356669932320E-01
 LT= 8.745824966893480E+02 RG= 2.621932364062765E+08 RR= 1.634251320591819E+01
2443495.501388889 = A.D. 1977-Dec-18 00:02:00.0000 TDB 
 X = 8.419825833757453E+07 Y = 2.503473127528505E+08 Z = 2.169765966882819E+07
 VX=-1.573811940009511E+01 VY= 2.250965445816887E+01 VZ= 9.001878572210025E-01
 LT= 8.840009405239948E+02 RG= 2.650168148340002E+08 RR= 1.633723216421934E+01
2443497.501388889 = A.D. 1977-Dec-20 00:02:00.0000 TDB 
 X = 8.147003223177101E+07 Y = 2.542105539840377E+08 Z = 2.185093154493746E+07
 VX=-1.583749579171356E+01 VY= 2.220462727679502E+01 VZ= 8.739007316251630E-01
 LT= 8.934153919947751E+02 RG= 2.678391963811471E+08 RR= 1.632869614521196E+01
2443499.501388889 = A.D. 1977-Dec-22 00:02:00.0000 TDB 
 X = 7.872518239154172E+07 Y = 2.580215210779015E+08 Z = 2.199971673707031E+07
 VX=-1.593057649979232E+01 VY= 2.190461968660941E+01 VZ= 8.482555526859965E-01
 LT= 9.028240354515966E+02 RG= 2.706598367295133E+08 RR= 1.631711296684424E+01
2443501.501388889 = A.D. 1977-Dec-24 00:02:00.0000 TDB 
 X = 7.596476982694006E+07 Y = 2.617810760792049E+08 Z = 2.214412458199885E+07
 VX=-1.601766999006002E+01 VY= 2.160956909779883E+01 VZ= 8.232339645324656E-01
 LT= 9.122251713737585E+02 RG= 2.734782263756103E+08 RR= 1.630267788638574E+01
2443503.501388889 = A.D. 1977-Dec-26 00:02:00.0000 TDB 
 X = 7.318980361797118E+07 Y = 2.654900698365413E+08 Z = 2.228426127915978E+07
 VX=-1.609906897079549E+01 VY= 2.131940864121128E+01 VZ= 7.988180144671819E-01
 LT= 9.216172093458541E+02 RG= 2.762938885248941E+08 RR= 1.628557434258167E+01
2443505.501388889 = A.D. 1977-Dec-28 00:02:00.0000 TDB 
 X = 7.040124356994930E+07 Y = 2.691493413259906E+08 Z = 2.242022996181777E+07
 VX=-1.617505116964443E+01 VY= 2.103406788595644E+01 VZ= 7.749901694075190E-01
 LT= 9.309986614501887E+02 RG= 2.791063771108620E+08 RR= 1.626597466016981E+01
2443507.501388889 = A.D. 1977-Dec-30 00:02:00.0000 TDB 
 X = 6.760000273708700E+07 Y = 2.727597170921803E+08 Z = 2.255213077065779E+07
 VX=-1.624588008244957E+01 VY= 2.075347348045448E+01 VZ= 7.517333277535343E-01
 LT= 9.403681360556928E+02 RG= 2.819152749330146E+08 RR= 1.624404071957124E+01
2443509.501388889 = A.D. 1978-Jan-01 00:02:00.0000 TDB 
 X = 6.478694981891111E+07 Y = 2.763220107934402E+08 Z = 2.268006092910938E+07
 VX=-1.631180569558308E+01 VY= 2.047754971852591E+01 VZ= 7.290308276589936E-01
 LT= 9.497243319807773E+02 RG= 2.847201919069252E+08 RR= 1.621992458613657E+01
2443511.501388889 = A.D. 1978-Jan-03 00:02:00.0000 TDB 
 X = 6.196291143452819E+07 Y = 2.798370228394767E+08 Z = 2.280411481979285E+07
 VX=-1.637306517758685E+01 VY= 2.020621904499264E+01 VZ= 7.068664517747747E-01
 LT= 9.590660330099008E+02 RG= 2.875207634203473E+08 RR= 1.619376910809057E+01
2443513.501388889 = A.D. 1978-Jan-05 00:02:00.0000 TDB 
 X = 5.912867427977797E+07 Y = 2.833055401112016E+08 Z = 2.292438406154487E+07
 VX=-1.642988354254740E+01 VY= 1.993940250141054E+01 VZ= 6.852244293597138E-01
 LT= 9.683921027444021E+02 RG= 2.903166487895329E+08 RR= 1.616570847820764E+01
2443515.501388889 = A.D. 1978-Jan-07 00:02:00.0000 TDB 
 X = 5.628498717238128E+07 Y = 2.867283357529685E+08 Z = 2.304095758659939E+07
 VX=-1.648247428406778E+01 VY= 1.967702012006711E+01 VZ= 6.640894359794922E-01
 LT= 9.777014797675247E+02 RG= 2.931075298097435E+08 RR= 1.613586876309430E+01
2443517.501388889 = A.D. 1978-Jan-09 00:02:00.0000 TDB 
 X = 5.343256299000970E+07 Y = 2.901061690288996E+08 Z = 2.315392171752641E+07
 VX=-1.653103997954159E+01 VY= 1.941899127221741E+01 VZ= 6.434465910678346E-01
 LT= 9.869931731057892E+02 RG= 2.958931093946040E+08 RR= 1.610436840229203E+01
2443519.501388889 = A.D. 1978-Jan-11 00:02:00.0000 TDB 
 X = 5.057208050644431E+07 Y = 2.934397852356575E+08 Z = 2.326336024360204E+07
 VX=-1.657577286621745E+01 VY= 1.916523497385274E+01 VZ= 6.232814538619564E-01
 LT= 9.962662579692843E+02 RG= 2.986731102990738E+08 RR= 1.607131867699511E+01
2443521.501388889 = A.D. 1978-Jan-13 00:02:00.0000 TDB 
 X = 4.770418613058565E+07 Y = 2.967299156647104E+08 Z = 2.336935449635462E+07
 VX=-1.661685538943418E+01 VY= 1.891567015355770E+01 VZ= 6.035800179560837E-01
 LT= 1.005519871753756E+03 RG= 3.014472739209031E+08 RR= 1.603682415014659E+01
2443523.501388889 = A.D. 1978-Jan-15 00:02:00.0000 TDB 
 X = 4.482949555312231E+07 Y = 2.999772776079484E+08 Z = 2.347198342406313E+07
 VX=-1.665446072339238E+01 VY= 1.867021588709131E+01 VZ= 5.843287046263459E-01
 LT= 1.014753210288686E+03 RG= 3.042153591758363E+08 RR= 1.600098308014418E+01
2443525.501388889 = A.D. 1978-Jan-17 00:02:00.0000 TDB 
 X = 4.194859530546948E+07 Y = 3.031825744012070E+08 Z = 2.357132366500302E+07
 VX=-1.668875326529374E+01 VY= 1.842879160217522E+01 VZ= 5.655143551552841E-01
 LT= 1.023965524316507E+03 RG= 3.069771414421045E+08 RR= 1.596388780953906E+01
2443527.501388889 = A.D. 1978-Jan-19 00:02:00.0000 TDB 
 X = 3.906204423563173E+07 Y = 3.063464955008172E+08 Z = 2.366744961931528E+07
 VX=-1.671988910428996E+01 VY= 1.819131725601679E+01 VZ= 5.471242224138182E-01
 LT= 1.033156116188960E+03 RG= 3.097324115700219E+08 RR= 1.592562512939334E+01
2443529.501388889 = A.D. 1978-Jan-21 00:02:00.0000 TDB 
 X = 3.617037490502954E+07 Y = 3.094697165886406E+08 Z = 2.376043351935336E+07
 VX=-1.674801646608076E+01 VY= 1.795771348836622E+01 VZ= 5.291459618760976E-01
 LT= 1.042324336766599E+03 RG= 3.124809749524786E+08 RR= 1.588627662063293E+01
2443531.501388889 = A.D. 1978-Jan-23 00:02:00.0000 TDB 
 X = 3.327409491060989E+07 Y = 3.125528997016945E+08 Z = 2.385034549844047E+07
 VX=-1.677327613384015E+01 VY= 1.772790175341206E+01 VZ= 5.115676221106327E-01
 LT= 1.051469582508986E+03 RG= 3.152226506526026E+08 RR= 1.584591897444075E+01
2443533.501388889 = A.D. 1978-Jan-25 00:02:00.0000 TDB 
 X = 3.037368813620233E+07 Y = 3.155966933829348E+08 Z = 2.393725365794230E+07
 VX=-1.679580184630976E+01 VY= 1.750180443310031E+01 VZ= 4.943776348418005E-01
 LT= 1.060591292743906E+03 RG= 3.179572705850931E+08 RR= 1.580462429321030E+01
2443535.501388889 = A.D. 1978-Jan-27 00:02:00.0000 TDB 
 X = 2.746961593692128E+07 Y = 3.186017328500714E+08 Z = 2.402122413260525E+07
 VX=-1.681572067498919E+01 VY= 1.727934493251796E+01 VZ= 4.775648048717498E-01
 LT= 1.069688947104405E+03 RG= 3.206846787478615E+08 RR= 1.576246037173423E+01
2443537.501388889 = A.D. 1978-Jan-29 00:02:00.0000 TDB 
 X = 2.456231826013024E+07 Y = 3.215686401794481E+08 Z = 2.410232115414675E+07
 VX=-1.683315338089157E+01 VY= 1.706044775985829E+01 VZ= 4.611182998479615E-01
 LT= 1.078762063122468E+03 RG= 3.234047305006359E+08 RR= 1.571949096047651E+01
2443539.501388889 = A.D. 1978-Jan-31 00:02:00.0000 TDB 
 X = 2.165221470657800E+07 Y = 3.244980245027516E+08 Z = 2.418060711304320E+07
 VX=-1.684821475093058E+01 VY= 1.684503859457286E+01 VZ= 4.450276397460637E-01
 LT= 1.087810193970312E+03 RG= 3.261172918878168E+08 RR= 1.567577601396101E+01
2443541.501388889 = A.D. 1978-Feb-02 00:02:00.0000 TDB 
 X = 1.873970553486881E+07 Y = 3.273904822142003E+08 Z = 2.425614261852877E+07
 VX=-1.686101391718882E+01 VY= 1.663304434094623E+01 VZ= 4.292826866263004E-01
 LT= 1.096832926339468E+03 RG= 3.288222390026420E+08 RR= 1.563137192090676E+01
2443543.501388889 = A.D. 1978-Feb-04 00:02:00.0000 TDB 
 X = 1.582517261241238E+07 Y = 3.302465971862493E+08 Z = 2.432898655680022E+07
 VX=-1.687165465731834E+01 VY= 1.642439317366191E+01 VZ= 4.138736341303675E-01
 LT= 1.105829878448930E+03 RG= 3.315194573900458E+08 RR= 1.558633172243468E+01
2443545.501388889 = A.D. 1978-Feb-06 00:02:00.0000 TDB 
 X = 1.290898031612467E+07 Y = 3.330669409922156E+08 Z = 2.439919614742620E+07
 VX=-1.688023567924602E+01 VY= 1.621901457225843E+01 VZ= 3.987909972397246E-01
 LT= 1.114800698174705E+03 RG= 3.342088414859109E+08 RR= 1.554070531481671E+01
2443547.501388889 = A.D. 1978-Feb-08 00:02:00.0000 TDB 
 X = 9.991476383956430E+06 Y = 3.358520731342671E+08 Z = 2.446682699799578E+07
 VX=-1.688685088961044E+01 VY= 1.601683934728446E+01 VZ= 3.840256021339261E-01
 LT= 1.123745061292788E+03 RG= 3.368902940903257E+08 RR= 1.549453963951752E+01
2443549.501388889 = A.D. 1978-Feb-10 00:02:00.0000 TDB 
 X = 7.072992724073038E+06 Y = 3.386025412750075E+08 Z = 2.453193315702218E+07
 VX=-1.689158964744016E+01 VY= 1.581779966033432E+01 VZ= 3.695685760842435E-01
 LT= 1.132662669827611E+03 RG= 3.395637258724620E+08 RR= 1.544787886227107E+01
2443551.501388889 = A.D. 1978-Feb-12 00:02:00.0000 TDB 
 X = 4.153846178696907E+06 Y = 3.413188814722960E+08 Z = 2.459456716511373E+07
 VX=-1.689453700371256E+01 VY= 1.562182903674981E+01 VZ= 3.554113376023826E-01
 LT= 1.141553250501220E+03 RG= 3.422290549056506E+08 RR= 1.540076454019403E+01
2443553.501388889 = A.D. 1978-Feb-14 00:02:00.0000 TDB 
 X = 1.234339249063871E+06 Y = 3.440016184155241E+08 Z = 2.465478010446610E+07
 VX=-1.689577392773026E+01 VY= 1.542886237240965E+01 VZ= 3.415455868111312E-01
 LT= 1.150416553275101E+03 RG= 3.448862062302306E+08 RR= 1.535323577806614E+01
2443555.501388889 = A.D. 1978-Feb-16 00:02:00.0000 TDB 
 X =-1.685239217896004E+06 Y = 3.466512656626929E+08 Z = 2.471262164670493E+07
 VX=-1.689537752071063E+01 VY= 1.523883593593830E+01 VZ= 3.279632959848167E-01
 LT= 1.159252349979404E+03 RG= 3.475351114426017E+08 RR= 1.530532937517128E+01
2443557.501388889 = A.D. 1978-Feb-18 00:02:00.0000 TDB 
 X =-4.604613378739422E+06 Y = 3.492683258775273E+08 Z = 2.476814009911017E+07
 VX=-1.689342121741266E+01 VY= 1.505168736691029E+01 VZ= 3.146567002819998E-01
 LT= 1.168060433024243E+03 RG= 3.501757083088823E+08 RR= 1.525707996325699E+01
2443559.501388889 = A.D. 1978-Feb-20 00:02:00.0000 TDB 
 X =-7.523519776564829E+06 Y = 3.518532910659252E+08 Z = 2.482138244925985E+07
 VX=-1.688997497671069E+01 VY= 1.486735566995175E+01 VZ= 3.016182887471670E-01
 LT= 1.176840614187948E+03 RG= 3.528079404016348E+08 RR= 1.520852013555463E+01
2443561.501388889 = A.D. 1978-Feb-22 00:02:00.0000 TDB 
 X =-1.044170675609209E+07 Y = 3.544066428110550E+08 Z = 2.487239440814567E+07
 VX=-1.688510546174187E+01 VY= 1.468578120514591E+01 VZ= 2.888407955957630E-01
 LT= 1.185592723477185E+03 RG= 3.554317567581395E+08 RR= 1.515968056733433E+01
2443563.501388889 = A.D. 1978-Feb-24 00:02:00.0000 TDB 
 X =-1.335893390898920E+07 Y = 3.569288525065625E+08 Z = 2.492122045180093E+07
 VX=-1.687887620987303E+01 VY= 1.450690567596837E+01 VZ= 2.763171917079941E-01
 LT= 1.194316608054433E+03 RG= 3.580471115588610E+08 RR= 1.511059012928187E+01
2443565.501388889 = A.D. 1978-Feb-26 00:02:00.0000 TDB 
 X =-1.627497154771945E+07 Y = 3.594203815875416E+08 Z = 2.496790386147405E+07
 VX=-1.687134779298261E+01 VY= 1.433067211542360E+01 VZ= 2.640406763112297E-01
 LT= 1.203012131228968E+03 RG= 3.606539638249509E+08 RR= 1.506127599443794E+01
2443567.501388889 = A.D. 1978-Feb-28 00:02:00.0000 TDB 
 X =-1.918960020633836E+07 Y = 3.618816817588751E+08 Z = 2.501248676239207E+07
 VX=-1.686257796933492E+01 VY= 1.415702486919446E+01 VZ= 2.520046690127407E-01
 LT= 1.211679171507395E+03 RG= 3.632522771336055E+08 RR= 1.501176373765207E+01
2443569.501388889 = A.D. 1978-Mar-02 00:02:00.0000 TDB 
 X =-2.210261016683874E+07 Y = 3.643131952204210E+08 Z = 2.505501016117664E+07
 VX=-1.685262182709748E+01 VY= 1.398590957668908E+01 VZ= 2.402028020773894E-01
 LT= 1.220317621699434E+03 RG= 3.658420193499874E+08 RR= 1.496207742853954E+01
2443571.501388889 = A.D. 1978-Mar-04 00:02:00.0000 TDB 
 X =-2.501380100952703E+07 Y = 3.667153548890345E+08 Z = 2.509551398192838E+07
 VX=-1.684153191962812E+01 VY= 1.381727315313436E+01 VZ= 2.286289128788672E-01
 LT= 1.228927388076389E+03 RG= 3.684231623749406E+08 RR= 1.491223972116116E+01
2443573.501388889 = A.D. 1978-Mar-06 00:02:00.0000 TDB 
 X =-2.792298118624747E+07 Y = 3.690885846170442E+08 Z = 2.513403710104243E+07
 VX=-1.682935839336905E+01 VY= 1.365106376593510E+01 VZ= 2.172770366352008E-01
 LT= 1.237508389578635E+03 RG= 3.709956819074005E+08 RR= 1.486227193381970E+01
2443575.501388889 = A.D. 1978-Mar-08 00:02:00.0000 TDB 
 X =-3.082996761481338E+07 Y = 3.714332994069218E+08 Z = 2.517061738079670E+07
 VX=-1.681614910889842E+01 VY= 1.348723081490906E+01 VZ= 2.061413993789758E-01
 LT= 1.246060557068770E+03 RG= 3.735595572204959E+08 RR= 1.481219412866386E+01
2443577.501388889 = A.D. 1978-Mar-10 00:02:00.0000 TDB 
 X =-3.373458529427350E+07 Y = 3.737499056222018E+08 Z = 2.520529170171763E+07
 VX=-1.680194975552032E+01 VY= 1.332572490901198E+01 VZ= 1.952164112652586E-01
 LT= 1.254583832628537E+03 RG= 3.761147709507698E+08 RR= 1.476202518391917E+01
2443579.501388889 = A.D. 1978-Mar-12 00:02:00.0000 TDB 
 X =-3.663666693898644E+07 Y = 3.760388011943644E+08 Z = 2.523809599384199E+07
 VX=-1.678680395945577E+01 VY= 1.316649784199330E+01 VZ= 1.844966599693114E-01
 LT= 1.263078168896118E+03 RG= 3.786613088995064E+08 RR= 1.471178286123042E+01
2443581.501388889 = A.D. 1978-Mar-14 00:02:00.0000 TDB 
 X =-3.953605263105707E+07 Y = 3.783003758255734E+08 Z = 2.526906526683812E+07
 VX=-1.677075338592508E+01 VY= 1.300950256947256E+01 VZ= 1.739769043685069E-01
 LT= 1.271543528441427E+03 RG= 3.811991598454482E+08 RR= 1.466148387074362E+01
2443583.501388889 = A.D. 1978-Mar-16 00:02:00.0000 TDB 
 X =-4.243258948992917E+07 Y = 3.805350111873701E+08 Z = 2.529823363906017E+07
 VX=-1.675383783609025E+01 VY= 1.285469318466313E+01 VZ= 1.636520684584815E-01
 LT= 1.279979883177624E+03 RG= 3.837283153683726E+08 RR= 1.461114393134291E+01
2443585.501388889 = A.D. 1978-Mar-18 00:02:00.0000 TDB 
 X =-4.532613135826135E+07 Y = 3.827430811150953E+08 Z = 2.532563436557260E+07
 VX=-1.673609533861596E+01 VY= 1.270202489345403E+01 VZ= 1.535172355028305E-01
 LT= 1.288387213806101E+03 RG= 3.862487696827026E+08 RR= 1.456077782683679E+01
2443587.501388889 = A.D. 1978-Mar-20 00:02:00.0000 TDB 
 X =-4.821653850319853E+07 Y = 3.849249517980325E+08 Z = 2.535129986517978E+07
 VX=-1.671756223638827E+01 VY= 1.255145398988672E+01 VZ= 1.435676423792227E-01
 LT= 1.296765509292998E+03 RG= 3.887605194805696E+08 RR= 1.451039945926824E+01
2443589.501388889 = A.D. 1978-Mar-22 00:02:00.0000 TDB 
 X =-5.110367733221877E+07 Y = 3.870809819653484E+08 Z = 2.537526174649522E+07
 VX=-1.669827326841866E+01 VY= 1.240293783188268E+01 VZ= 1.337986740952521E-01
 LT= 1.305114766375636E+03 RG= 3.912635637838476E+08 RR= 1.446002189929668E+01
2443591.501388889 = A.D. 1978-Mar-24 00:02:00.0000 TDB 
 X =-5.398742012273957E+07 Y = 3.892115230678066E+08 Z = 2.539755083307880E+07
 VX=-1.667826164745755E+01 VY= 1.225643481664105E+01 VZ= 1.242058585258494E-01
 LT= 1.313434989097012E+03 RG= 3.937579038045964E+08 RR= 1.440965743322780E+01
2443593.501388889 = A.D. 1978-Mar-26 00:02:00.0000 TDB 
 X =-5.686764476481245E+07 Y = 3.913169194552119E+08 Z = 2.541819718768877E+07
 VX=-1.665755913376140E+01 VY= 1.211190435579558E+01 VZ= 1.147848613992162E-01
 LT= 1.321726188366499E+03 RG= 3.962435428133637E+08 RR= 1.435931760693667E+01
2443595.501388889 = A.D. 1978-Mar-28 00:02:00.0000 TDB 
 X =-5.974423451624078E+07 Y = 3.933975085495667E+08 Z = 2.543723013567886E+07
 VX=-1.663619610476245E+01 VY= 1.196930685109163E+01 VZ= 1.055314814291188E-01
 LT= 1.329988381545089E+03 RG= 3.987204860148441E+08 RR= 1.430901326748752E+01
2443597.501388889 = A.D. 1978-Mar-30 00:02:00.0000 TDB 
 X =-6.261707776924192E+07 Y = 3.954536210142069E+08 Z = 2.545467828757033E+07
 VX=-1.661420162069803E+01 VY= 1.182860367086913E+01 VZ= 9.644164553926782E-02
 LT= 1.338221592054358E+03 RG= 4.011887404306495E+08 RR= 1.425875460279482E+01
2443599.501388889 = A.D. 1978-Apr-01 00:02:00.0000 TDB 
 X =-6.548606782846753E+07 Y = 3.974855809186658E+08 Z = 2.547056956080842E+07
 VX=-1.659160348775859E+01 VY= 1.168975712619111E+01 VZ= 8.751140445852368E-02
 LT= 1.346425849007013E+03 RG= 4.036483147885494E+08 RR= 1.420855117852682E+01
2443601.501388889 = A.D. 1978-Apr-03 00:02:00.0000 TDB 
 X =-6.835110269946213E+07 Y = 3.994937058995231E+08 Z = 2.548493120079580E+07
 VX=-1.656842831759187E+01 VY= 1.155273044661295E+01 VZ= 7.873692839168900E-02
 LT= 1.354601186858277E+03 RG= 4.060992194179600E+08 RR= 1.415841197213785E+01
2443603.501388889 = A.D. 1978-Apr-05 00:02:00.0000 TDB 
 X =-7.121208488695100E+07 Y = 4.014783073172579E+08 Z = 2.549778980114684E+07
 VX=-1.654470158211335E+01 VY= 1.141748775862527E+01 VZ= 7.011450266595443E-02
 LT= 1.362747645076712E+03 RG= 4.085414661512591E+08 RR= 1.410834540687747E+01
2443605.501388889 = A.D. 1978-Apr-07 00:02:00.0000 TDB 
 X =-7.406892120276818E+07 Y = 4.034396904091265E+08 Z = 2.550917132325751E+07
 VX=-1.652044766852328E+01 VY= 1.128399406126373E+01 VZ= 6.164052392362240E-02
 LT= 1.370865267833417E+03 RG= 4.109750682306081E+08 RR= 1.405835938128543E+01
2443607.501388889 = A.D. 1978-Apr-09 00:02:00.0000 TDB 
 X =-7.692152258268653E+07 Y = 4.053781544380720E+08 Z = 2.551910111519569E+07
 VX=-1.649568992887126E+01 VY= 1.115221520526653E+01 VZ= 5.331149610301011E-02
 LT= 1.378954103708180E+03 RG= 4.134000402198622E+08 RR= 1.400846129953819E+01
2443609.501388889 = A.D. 1978-Apr-11 00:02:00.0000 TDB 
 X =-7.976980391182636E+07 Y = 4.072939928380998E+08 Z = 2.552760392989504E+07
 VX=-1.647045072832730E+01 VY= 1.102211787037650E+01 VZ= 4.512402677936311E-02
 LT= 1.387014205412895E+03 RG= 4.158163979216487E+08 RR= 1.395865809811788E+01
2443611.501388889 = A.D. 1978-Apr-13 00:02:00.0000 TDB 
 X =-8.261368385798831E+07 Y = 4.091874933554413E+08 Z = 2.553470394279343E+07
 VX=-1.644475149076504E+01 VY= 1.089366954378779E+01 VZ= 3.707482356919511E-02
 LT= 1.395045629528695E+03 RG= 4.182241582985649E+08 RR= 1.390895627157227E+01
2443613.501388889 = A.D. 1978-Apr-15 00:02:00.0000 TDB 
 X =-8.545308471282494E+07 Y = 4.110589381864260E+08 Z = 2.554042476879078E+07
 VX=-1.641861274182972E+01 VY= 1.076683849956826E+01 VZ= 2.916069065858506E-02
 LT= 1.403048436258896E+03 RG= 4.206233393991107E+08 RR= 1.385936189728753E+01
2443615.501388889 = A.D. 1978-Apr-17 00:02:00.0000 TDB 
 X =-8.828793224018428E+07 Y = 4.129086041116498E+08 Z = 2.554478947865361E+07
 VX=-1.639205414999943E+01 VY= 1.064159377808032E+01 VZ= 2.137852548250363E-02
 LT= 1.411022689195156E+03 RG= 4.230139602875859E+08 RR= 1.380988065846392E+01
2443617.501388889 = A.D. 1978-Apr-19 00:02:00.0000 TDB 
 X =-9.111815553139305E+07 Y = 4.147367626266057E+08 Z = 2.554782061485261E+07
 VX=-1.636509456561616E+01 VY= 1.051790516542821E+01 VZ= 1.372531555133349E-02
 LT= 1.418968455096450E+03 RG= 4.253960409778273E+08 RR= 1.376051786538327E+01
2443619.501388889 = A.D. 1978-Apr-21 00:02:00.0000 TDB 
 X =-9.394368686710852E+07 Y = 4.165436800688342E+08 Z = 2.554954020686075E+07
 VX=-1.633775205788780E+01 VY= 1.039574317379024E+01 VZ= 6.198135374611891E-03
 LT= 1.426885803680043E+03 RG= 4.277696023705456E+08 RR= 1.371127847585586E+01
2443621.501388889 = A.D. 1978-Apr-23 00:02:00.0000 TDB 
 X =-9.676446158539762E+07 Y = 4.183296177417532E+08 Z = 2.554996978592733E+07
 VX=-1.631004394999798E+01 VY= 1.027507902256236E+01 VZ=-1.205856520511972E-03
 LT= 1.434774807424039E+03 RG= 4.301346661941293E+08 RR= 1.366216711484643E+01
2443623.501388889 = A.D. 1978-Apr-25 00:02:00.0000 TDB 
 X =-9.958041795572026E+07 Y = 4.200948320352730E+08 Z = 2.554913039935210E+07
 VX=-1.628198685254604E+01 VY= 1.015588461963330E+01 VZ=-8.489420458283714E-03
 LT= 1.442635541380926E+03 RG= 4.324912549487483E+08 RR= 1.361318809271169E+01
2443625.501388889 = A.D. 1978-Apr-27 00:02:00.0000 TDB 
 X =-1.023914970586292E+08 Y = 4.218395745430463E+08 Z = 2.554704262425390E+07
 VX=-1.625359669535292E+01 VY= 1.003813254264202E+01 VZ=-1.565523827415749E-02
 LT= 1.450468083000850E+03 RG= 4.348393918533727E+08 RR= 1.356434542197274E+01
2443627.501388889 = A.D. 1978-Apr-29 00:02:00.0000 TDB 
 X =-1.051976426706743E+08 Y = 4.235640921767821E+08 Z = 2.554372658093151E+07
 VX=-1.622488875771414E+01 VY= 9.921796021060477E+00 VZ=-2.270591602941563E-02
 LT= 1.458272511965025E+03 RG= 4.371791007958293E+08 RR= 1.351564283347986E+01
2443629.501388889 = A.D. 1978-May-01 00:02:00.0000 TDB 
 X =-1.079988011545480E+08 Y = 4.252686272773281E+08 Z = 2.553920194571534E+07
 VX=-1.619587769701396E+01 VY= 9.806848919442990E+00 VZ=-2.964398654302647E-02
 LT= 1.466048910027728E+03 RG= 4.395104062854334E+08 RR= 1.346708379234166E+01
2443631.501388889 = A.D. 1978-May-03 00:02:00.0000 TDB 
 X =-1.107949213539886E+08 Y = 4.269534177229614E+08 Z = 2.553348796341625E+07
 VX=-1.616657757616976E+01 VY= 9.693265720091990E+00 VZ=-3.647191182032428E-02
 LT= 1.473797360867389E+03 RG= 4.418333334083476E+08 RR= 1.341867151205641E+01
2443633.501388889 = A.D. 1978-May-05 00:02:00.0000 TDB 
 X =-1.135859544933365E+08 Y = 4.286186970346140E+08 Z = 2.552660345936245E+07
 VX=-1.613700188969079E+01 VY= 9.581021505966971E+00 VZ=-4.319208537931285E-02
 LT= 1.481517949945276E+03 RG= 4.441479077852152E+08 RR= 1.337040896764773E+01
2443635.501388889 = A.D. 1978-May-07 00:02:00.0000 TDB 
 X =-1.163718540814456E+08 Y = 4.302646944784087E+08 Z = 2.551856685102871E+07
 VX=-1.610716358829753E+01 VY= 9.470091945912444E+00 VZ=-4.980683458897461E-02
 LT= 1.489210764372217E+03 RG= 4.464541555312058E+08 RR= 1.332229890981485E+01
2443637.501388889 = A.D. 1978-May-09 00:02:00.0000 TDB 
 X =-1.191525758197936E+08 Y = 4.318916351654094E+08 Z = 2.550939615928495E+07
 VX=-1.607707510263797E+01 VY= 9.360453277450301E+00 VZ=-5.631842277164445E-02
 LT= 1.496875892782452E+03 RG= 4.487521032181957E+08 RR= 1.327434387569000E+01
2443639.501388889 = A.D. 1978-May-11 00:02:00.0000 TDB 
 X =-1.219280775145559E+08 Y = 4.334997401486524E+08 Z = 2.549910901927608E+07
 VX=-1.604674836566926E+01 VY= 9.252082292873292E+00 VZ=-6.272905136589024E-02
 LT= 1.504513425214156E+03 RG= 4.510417778389511E+08 RR= 1.322654620164938E+01
2443641.501388889 = A.D. 1978-May-13 00:02:00.0000 TDB 
 X =-1.246983189924758E+08 Y = 4.350892265177161E+08 Z = 2.548772269094086E+07
 VX=-1.601619483411410E+01 VY= 9.144956323860825E+00 VZ=-6.904086191791681E-02
 LT= 1.512123452996885E+03 RG= 4.533232067733837E+08 RR= 1.317890803371237E+01
2443643.501388889 = A.D. 1978-May-15 00:02:00.0000 TDB 
 X =-1.274632620203439E+08 Y = 4.366603074906152E+08 Z = 2.547525406919411E+07
 VX=-1.598542550881343E+01 VY= 9.039053226693504E+00 VZ=-7.525593801851871E-02
 LT= 1.519706068644663E+03 RG= 4.555964177565001E+08 RR= 1.313143133751517E+01
2443645.501388889 = A.D. 1978-May-17 00:02:00.0000 TDB 
 X =-1.302228702279119E+08 Y = 4.382131925032930E+08 Z = 2.546171969377574E+07
 VX=-1.595445095413742E+01 VY= 8.934351368885915E+00 VZ=-8.137630720600253E-02
 LT= 1.527261365755035E+03 RG= 4.578614388481391E+08 RR= 1.308411790870875E+01
2443647.501388889 = A.D. 1978-May-19 00:02:00.0000 TDB 
 X =-1.329771090340843E+08 Y = 4.397480872967908E+08 Z = 2.544713575877950E+07
 VX=-1.592328131651357E+01 VY= 8.830829615549961E+00 VZ=-8.740394277047514E-02
 LT= 1.534789438913821E+03 RG= 4.601182984044152E+08 RR= 1.303696938220547E+01
2443649.501388889 = A.D. 1978-May-21 00:02:00.0000 TDB 
 X =-1.357259455762353E+08 Y = 4.412651940020462E+08 Z = 2.543151812187731E+07
 VX=-1.589192634208774E+01 VY= 8.728467315747219E+00 VZ=-9.334076547658077E-02
 LT= 1.542290383604892E+03 RG= 4.623670250506734E+08 RR= 1.298998724055740E+01
2443651.501388889 = A.D. 1978-May-23 00:02:00.0000 TDB 
 X =-1.384693486425063E+08 Y = 4.427647112223966E+08 Z = 2.541488231324977E+07
 VX=-1.586039539355140E+01 VY= 8.627244289637396E+00 VZ=-9.918864524145121E-02
 LT= 1.549764296124748E+03 RG= 4.646076476558781E+08 RR= 1.294317282227013E+01
2443653.501388889 = A.D. 1978-May-25 00:02:00.0000 TDB 
 X =-1.412072886068687E+08 Y = 4.442468341139273E+08 Z = 2.539724354422453E+07
 VX=-1.582869746630992E+01 VY= 8.527140816284216E+00 VZ=-1.049494027509188E-01
 LT= 1.557211273501787E+03 RG= 4.668401953084111E+08 RR= 1.289652732998929E+01
2443655.501388889 = A.D. 1978-May-27 00:02:00.0000 TDB 
 X =-1.439397373672851E+08 Y = 4.457117544637357E+08 Z = 2.537861671567470E+07
 VX=-1.579684120332891E+01 VY= 8.428137621734866E+00 VZ=-1.106248110785297E-01
 LT= 1.564631413420526E+03 RG= 4.690646972933537E+08 RR= 1.285005183802165E+01
2443657.501388889 = A.D. 1978-May-29 00:02:00.0000 TDB 
 X =-1.466666682856379E+08 Y = 4.471596607660871E+08 Z = 2.535901642607540E+07
 VX=-1.576483491044913E+01 VY= 8.330215866441106E+00 VZ=-1.162165970876483E-01
 LT= 1.572024814149036E+03 RG= 4.712811830707325E+08 RR= 1.280374729884897E+01
2443659.501388889 = A.D. 1978-May-31 00:02:00.0000 TDB 
 X =-1.493880561309843E+08 Y = 4.485907382965232E+08 Z = 2.533845697939205E+07
 VX=-1.573268656987006E+01 VY= 8.233357134362983E+00 VZ=-1.217264429245364E-01
 LT= 1.579391574471093E+03 RG= 4.734896822551789E+08 RR= 1.275761455021737E+01"""

# ESTRAGGO I DATI DAL BLOCCO PRECEDENTE
vx_pattern = re.compile(r'VX=\s*([\-\d.E+]+)')
vy_pattern = re.compile(r'VY=\s*([\-\d.E+]+)')
vz_pattern = re.compile(r'VZ=\s*([\-\d.E+]+)')
velocities = []
tempi = []

for block in data.split('\n'):
    time_match = re.match(r'([\d.]+)', block.strip())
    if time_match:
        tempi.append(float(time_match.group(1)))
    vx_match = vx_pattern.search(block)
    vy_match = vy_pattern.search(block)
    vz_match = vz_pattern.search(block)
    if vx_match and vy_match and vz_match:
        vx = float(vx_match.group(1))
        vy = float(vy_match.group(1))
        vz = float(vz_match.group(1))
        velocities.append([vx, vy, vz])

tempi = np.array(tempi)
velocities = np.array(velocities)

# Conversione array tempi in datetime
tempi_datetime = [jd_to_datetime(jd) for jd in tempi]

#print(len(tempi), " ", len(tempi_nuovi)) --> Debug

# Calcolo le differenze tra simulazione e dati horizon
diff = 1000*(vel_nuove - velocities)
index = 0

for i in range(len(tempi_datetime)):
    if tempi_datetime[i] > datetime(1977, 10, 15):
        index = i
        break 

#print((diff[len(diff)-1, 0]), (diff[len(diff)-1, 1]), (diff[len(diff)-1, 2]))
print(diff[index, 0], diff[index, 1], diff[index, 2]) # Mando a schermo la differenza dell'ultimo dato

# Andamento della massa in relazione a quanta deltaV è stata prodotta
massa0 = 807.6258119502719 # Massa aggiornata all'ultima TCM
# total_delta_v = np.linalg.norm(diff[len(diff)-1])
total_delta_v = np.linalg.norm([-10.823419538086299, 47.08880790957682, -8.854442214513924])
print(total_delta_v)
mass = massa0*np.exp(-0.0005*total_delta_v/0.889)
print(mass)
delta_t = massa0*(1-np.exp(-0.0005*total_delta_v/0.889))/0.0005
print(delta_t)

# Grafico le differenze tra simulazione e dati horizon per ciascuna componente dimensionale
plt.figure(figsize=(12,8))
componenti = ['x', 'y', 'z']
for i in range(3):
    plt.subplot(3,1,i+1)
    plt.plot(tempi_datetime, diff[:,i], marker='o')
    plt.ylabel(f'Diff v_{componenti[i]} (km/s)')
    if i == 0:
        plt.title('Differenza tra simulazione e nuovi dati per ciascuna componente')
plt.xlabel('Tempo (A.D.)')
plt.tight_layout()

# plt.plot(tempi, np.linalg.norm(velocities, axis=1), marker='o')
# plt.plot(tempi, np.linalg.norm(vel_nuove, axis=1), marker='o')
plt.show()